"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const AWS = require("aws-sdk");
const Conversor_1 = require("generic-stuff/dist/util/Conversor");
const dynamoDB = new AWS.DynamoDB.DocumentClient();
const handler = async (event) => {
    try {
        console.log('event', event);
        const data = await dynamoDB
            .scan({
            TableName: process.env.TABLE_NAME || '',
            Limit: event.arguments.input.limit || 20,
        })
            .promise();
        console.log('data', data);
        let result;
        if (!data.Items || data.Items.length === 0) {
            result = [];
        }
        else {
            result = Conversor_1.convertAttributeMapCollectionToCommentCollection(data.Items);
        }
        console.log('result', result);
        return result;
    }
    catch (error) {
        const body = error.stack || JSON.stringify(error, null, 2);
        console.error('ERROR!!!', body);
        throw error;
    }
};
exports.handler = handler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSwrQkFBK0I7QUFHL0IsaUVBQXFHO0FBRXJHLE1BQU0sUUFBUSxHQUFHLElBQUksR0FBRyxDQUFDLFFBQVEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztBQUU1QyxNQUFNLE9BQU8sR0FBaUYsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFO0lBQ25ILElBQUk7UUFDRixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUM1QixNQUFNLElBQUksR0FBRyxNQUFNLFFBQVE7YUFDeEIsSUFBSSxDQUFDO1lBQ0osU0FBUyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxJQUFJLEVBQUU7WUFDdkMsS0FBSyxFQUFFLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUssSUFBSSxFQUFFO1NBQ3pDLENBQUM7YUFDRCxPQUFPLEVBQUUsQ0FBQztRQUViLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzFCLElBQUksTUFBMEIsQ0FBQztRQUUvQixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDMUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztTQUNiO2FBQU07WUFDTCxNQUFNLEdBQUcsNERBQWdELENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3ZFO1FBRUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFOUIsT0FBTyxNQUFNLENBQUM7S0FDZjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDM0QsT0FBTyxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDaEMsTUFBTSxLQUFLLENBQUM7S0FDYjtBQUNILENBQUMsQ0FBQztBQTNCVyxRQUFBLE9BQU8sV0EyQmxCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwU3luY1Jlc29sdmVySGFuZGxlciB9IGZyb20gJ2F3cy1sYW1iZGEnO1xuaW1wb3J0ICogYXMgQVdTIGZyb20gJ2F3cy1zZGsnO1xuaW1wb3J0IHsgVGFibGVHdWVzdGJvb2tDb21tZW50RmlsdGVySW5wdXQgfSBmcm9tICdnZW5lcmljLXN0dWZmL2Rpc3QvdHlwZXMvVGFibGVHdWVzdGJvb2tDb21tZW50RmlsdGVySW5wdXQnO1xuaW1wb3J0IHsgR3Vlc3Rib29rQ29tbWVudCB9IGZyb20gJ2dlbmVyaWMtc3R1ZmYvZGlzdC90eXBlcy9HdWVzdGJvb2tDb21tZW50JztcbmltcG9ydCB7IGNvbnZlcnRBdHRyaWJ1dGVNYXBDb2xsZWN0aW9uVG9Db21tZW50Q29sbGVjdGlvbiB9IGZyb20gJ2dlbmVyaWMtc3R1ZmYvZGlzdC91dGlsL0NvbnZlcnNvcic7XG5cbmNvbnN0IGR5bmFtb0RCID0gbmV3IEFXUy5EeW5hbW9EQi5Eb2N1bWVudENsaWVudCgpO1xuXG5leHBvcnQgY29uc3QgaGFuZGxlcjogQXBwU3luY1Jlc29sdmVySGFuZGxlcjxUYWJsZUd1ZXN0Ym9va0NvbW1lbnRGaWx0ZXJJbnB1dCwgR3Vlc3Rib29rQ29tbWVudFtdPiA9IGFzeW5jIChldmVudCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdldmVudCcsIGV2ZW50KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgZHluYW1vREJcbiAgICAgIC5zY2FuKHtcbiAgICAgICAgVGFibGVOYW1lOiBwcm9jZXNzLmVudi5UQUJMRV9OQU1FIHx8ICcnLFxuICAgICAgICBMaW1pdDogZXZlbnQuYXJndW1lbnRzLmlucHV0LmxpbWl0IHx8IDIwLFxuICAgICAgfSlcbiAgICAgIC5wcm9taXNlKCk7XG5cbiAgICBjb25zb2xlLmxvZygnZGF0YScsIGRhdGEpO1xuICAgIGxldCByZXN1bHQ6IEd1ZXN0Ym9va0NvbW1lbnRbXTtcblxuICAgIGlmICghZGF0YS5JdGVtcyB8fCBkYXRhLkl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmVzdWx0ID0gW107XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdCA9IGNvbnZlcnRBdHRyaWJ1dGVNYXBDb2xsZWN0aW9uVG9Db21tZW50Q29sbGVjdGlvbihkYXRhLkl0ZW1zKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygncmVzdWx0JywgcmVzdWx0KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgYm9keSA9IGVycm9yLnN0YWNrIHx8IEpTT04uc3RyaW5naWZ5KGVycm9yLCBudWxsLCAyKTtcbiAgICBjb25zb2xlLmVycm9yKCdFUlJPUiEhIScsIGJvZHkpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuIl19